# OBV On Balance Volume
obv <- OBV(prices[,4], prices[,5])
obv$ema <- EMA(obv$obv,n=3) #compute the exponential moving average with n = 3
obv$ema[is.na(obv$ema)] <- 0
prices <- cbind(prices, obv)
# Semidev Calculations
semidev <- rep(NA, 13)
for (i in 14:length(prices$Adjusted)) {
semidev <- c(semidev, SemiDeviation(R = ROC(prices$Adjusted[(i-13):i], n = 1, type = "discrete"),
MAR=0))
}
prices <- cbind(prices, semidev)
prices
}
prices <- add_indicadores(prices)
#nrow(prices_total[is.na(prices_total$macd_signal), ])
#Interactive Plot
highchart(type="stock") %>%
hc_add_series(prices) %>%
hc_add_series(SMA(na.omit(Cl(prices)),n=50),name="SMA(50)") %>%
hc_add_series(SMA(na.omit(Cl(prices)),n=200),name="SMA(200)") %>%
#Interactive Plot
highchart(type="stock") %>%
hc_add_series(prices) %>%
hc_add_series(SMA(na.omit(Cl(prices)),n=50),name="SMA(50)") %>%
hc_add_series(SMA(na.omit(Cl(prices)),n=200),name="SMA(200)") %>%
hc_title(text="<b>BBRI Price Candle Stick Chart 2014-2023</b>")
#Interactive Plot
highchart(type="stock") %>%
hc_add_series(prices) %>%
hc_title(text="<b>BBRI Price Candle Stick Chart 2014-2023</b>")
#Interactive Plot
highchart(type="stock") %>%
hc_add_series(prices$Close) %>%
hc_title(text="<b>BBRI Price Candle Stick Chart 2014-2023</b>")
sum(prices$Close)
#Interactive Plot
highchart(type="stock") %>%
hc_add_series(unlist(prices$Close)) %>%
hc_title(text="<b>BBRI Price Candle Stick Chart 2014-2023</b>")
#Interactive Plot
highchart(type="stock") %>%
hc_add_series(data.frame(prices)) %>%
hc_title(text="<b>BBRI Price Candle Stick Chart 2014-2023</b>")
library(tidyverse)
library(dplyr)
library(quantmod)
library(TTR)
library(PerformanceAnalytics)
library("IRdisplay")
library(highcharter) #Interactive Plot
library(devtools)
library(yahoofinancer)
library(lubridate)
library(rvest)
library(httr)
library(readxl)
library(sets) # to fuzzy model
#---load data for a list of stocks---
# Web scraping to obtain symbols of stocks
page <- paste0('https://www.slickcharts.com/nasdaq100')
data_symbols <- read_html(page, encoding="UTF-8")
class(data_symbols)
html_text(data_symbols)
tabla <- data_symbols |> html_elements(xpath = '//div/table[@class="table table-hover table-borderless table-sm"]')
tabla <- tabla[[1]] |> html_table()
class(tabla)
symbols <- tabla |> select(Company, Symbol)
# ___Inputs___
from <- "2019-01-01"
to <- "2023-05-26"
stock <- symbols$Symbol[sample(1:nrow(symbols),1)]
# Market performance
market <- getSymbols("^NDX",from=from, to=to, src="yahoo", env = NULL)
# investment stock
prices <- getSymbols(stock,from=from, to=to, src="yahoo", env = NULL)
#Interactive Plot
highchart(type="stock") %>%
hc_add_series(prices) %>%
hc_title(text="<b>BBRI Price Candle Stick Chart 2014-2023</b>")
library(tidyverse)
library(dplyr)
library(quantmod)
library(TTR)
library(PerformanceAnalytics)
library("IRdisplay")
library(highcharter) #Interactive Plot
library(devtools)
library(yahoofinancer)
library(lubridate)
library(rvest)
library(httr)
library(readxl)
library(sets) # to fuzzy model
#---load data for a list of stocks---
# Web scraping to obtain symbols of stocks
page <- paste0('https://www.slickcharts.com/nasdaq100')
data_symbols <- read_html(page, encoding="UTF-8")
class(data_symbols)
html_text(data_symbols)
tabla <- data_symbols |> html_elements(xpath = '//div/table[@class="table table-hover table-borderless table-sm"]')
tabla <- tabla[[1]] |> html_table()
class(tabla)
symbols <- tabla |> select(Company, Symbol)
# ___Inputs___
from <- "2019-01-01"
to <- "2023-05-26"
stock <- symbols$Symbol[sample(1:nrow(symbols),1)]
# Market performance
market <- getSymbols("^NDX",from=from, to=to, src="yahoo", env = NULL)
# investment stock
prices <- getSymbols(stock,from=from, to=to, src="yahoo", env = NULL)
#Interactive Plot
highchart(type="stock") %>%
hc_add_series(prices) %>%
hc_title(text="<b>BBRI Price Candle Stick Chart 2014-2023</b>")
library(tidyverse)
library(dplyr)
library(quantmod)
library(TTR)
library(PerformanceAnalytics)
library("IRdisplay")
library(highcharter) #Interactive Plot
library(devtools)
library(yahoofinancer)
library(lubridate)
library(rvest)
library(httr)
library(readxl)
library(sets) # to fuzzy model
#---load data for a list of stocks---
# Web scraping to obtain symbols of stocks
page <- paste0('https://www.slickcharts.com/nasdaq100')
data_symbols <- read_html(page, encoding="UTF-8")
class(data_symbols)
html_text(data_symbols)
tabla <- data_symbols |> html_elements(xpath = '//div/table[@class="table table-hover table-borderless table-sm"]')
tabla <- tabla[[1]] |> html_table()
class(tabla)
symbols <- tabla |> select(Company, Symbol)
# ___Inputs___
from <- "2019-01-01"
to <- "2023-05-26"
stock <- symbols$Symbol[sample(1:nrow(symbols),1)]
# Market performance
market <- getSymbols("^NDX",from=from, to=to, src="yahoo", env = NULL)
# investment stock
prices <- getSymbols(stock,from=from, to=to, src="yahoo")
prices
prices
# investment stock
prices <- getSymbols(stock,from=from, to=to, src="yahoo", env = NULL)
#Interactive Plot
highchart(type="stock") %>%
hc_add_series(prices$REGN.Close) %>%
hc_title(text="<b>BBRI Price Candle Stick Chart 2014-2023</b>")
getSymbols(c("AMZN","DAL"))
View(AMZN)
highchart(type="stock") %>%
hc_add_series(AMZN) %>%
hc_title(text="<b>BBRI Price Candle Stick Chart 2014-2023</b>")
df <- AMZN
highchart(type="stock") %>%
hc_add_series(df) %>%
hc_title(text="<b>BBRI Price Candle Stick Chart 2014-2023</b>")
df <- AMZN
highchart(type="stock") %>%
hc_add_series(df) %>%
hc_add_series(SMA((Cl(df)),n=12),name="SMA(12)") %>%
hc_add_series(SMA((Cl(df)),n=26),name="SMA(26)") %>%
hc_title(text="<b>BBRI Price Candle Stick Chart 2014-2023</b>")
highchart(type="stock") %>%
hc_add_series(df) %>%
hc_add_series(SMA(na.omit(Cl(df)),n=50),name="SMA(50)") %>%
hc_add_series(SMA(na.omit(Cl(df)),n=200),name="SMA(200)") %>%
hc_title(text="<b>BBRI Price Candle Stick Chart 2014-2023</b>")
getSymbols(c("AMZN","DAL"))
df <- AMZN
highchart(type="stock") %>%
hc_add_series(df) %>%
hc_add_series(SMA(na.omit(Cl(df)),n=50),name="SMA(50)") %>%
hc_add_series(SMA(na.omit(Cl(df)),n=200),name="SMA(200)") %>%
hc_title(text="<b>BBRI Price Candle Stick Chart 2014-2023</b>")
Cl(df)
library(tidyverse)
library(dplyr)
library(quantmod)
library(TTR)
library(PerformanceAnalytics)
library("IRdisplay")
library(highcharter) #Interactive Plot
library(devtools)
library(yahoofinancer)
library(lubridate)
library(rvest)
library(httr)
library(readxl)
library(sets) # to fuzzy model
View(df)
highchart(type="stock") %>%
hc_add_series(df) %>%
hc_add_series(SMA(na.omit(Cl(df)),n=12),name="SMA(12)") %>%
hc_add_series(SMA(na.omit(Cl(df)),n=26),name="SMA(26)") %>%
hc_title(text="<b>BBRI Price Candle Stick Chart 2014-2023</b>")
View(df)
highchart(type="stock") %>%
hc_add_series(data.frame(df)) %>%
hc_add_series(SMA(na.omit(Cl(df)),n=12),name="SMA(12)") %>%
hc_add_series(SMA(na.omit(Cl(df)),n=26),name="SMA(26)") %>%
hc_title(text="<b>BBRI Price Candle Stick Chart 2014-2023</b>")
source("C:/Users/bravi/projects/finance1r/prediction1.R", echo=TRUE)
source("C:/Users/bravi/projects/finance1r/strategy_ttr.R", echo=TRUE)
source("C:/Users/bravi/projects/finance1r/strategy_ttr.R", echo=TRUE)
source("C:/Users/bravi/projects/finance1r/strategy_ttr.R", echo=TRUE)
highchart(type="stock") %>%
hc_add_series(df$AMZN.Close) %>%
hc_title(text="<b>BBRI Price Candle Stick Chart 2014-2023</b>")
as.numeric(df$AMZN.Close)
highchart(type="stock") %>%
hc_add_series(as.numeric(df$AMZN.Close)) %>%
hc_title(text="<b>BBRI Price Candle Stick Chart 2014-2023</b>")
x <- c(1, 2, 3, 4, 5)
highchart(type="stock") %>%
hc_add_series(as.numeric(x)) %>%
hc_title(text="<b>BBRI Price Candle Stick Chart 2014-2023</b>")
as.numeric(x)
install.packages(highcharter)
install.packages('highcharter')
install.packages("highcharter")
install.packages("highcharter")
install.packages("highcharter")
install.packages("highcharter")
source("C:/Users/bravi/projects/finance1r/strategy_ttr.R", echo=TRUE)
library(tidyverse)
library(dplyr)
library(quantmod)
library(TTR)
library(PerformanceAnalytics)
library("IRdisplay")
library(highcharter) #Interactive Plot
library(devtools)
library(yahoofinancer)
library(lubridate)
library(rvest)
library(httr)
library(readxl)
library(sets) # to fuzzy model
#---load data for a list of stocks---
# Web scraping to obtain symbols of stocks
page <- paste0('https://www.slickcharts.com/nasdaq100')
data_symbols <- read_html(page, encoding="UTF-8")
class(data_symbols)
html_text(data_symbols)
tabla <- data_symbols |> html_elements(xpath = '//div/table[@class="table table-hover table-borderless table-sm"]')
tabla <- tabla[[1]] |> html_table()
class(tabla)
symbols <- tabla |> select(Company, Symbol)
# ___Inputs___
from <- "2019-01-01"
to <- "2023-05-26"
stock <- symbols$Symbol[sample(1:nrow(symbols),1)]
# Market performance
market <- getSymbols("^NDX",from=from, to=to, src="yahoo", env = NULL)
# investment stock
prices <- getSymbols(stock,from=from, to=to, src="yahoo", env = NULL)
getSymbols(c("AMZN","DAL"))
df <- AMZN
getSymbols(c("AMZN","DAL"))
df <- AMZN
highchart(type="stock") %>%
hc_add_series(df) %>%
hc_title(text="<b>BBRI Price Candle Stick Chart 2014-2023</b>")
#____VIEW RESULTS OF STRATEGIES____
#Interactive Plot
highchart(type="stock") %>%
hc_yAxis_multiples(list(title = list(text = "Price"), opposite = FALSE),
list(showLastLabel = FALSE, opposite = TRUE, title = list(text = "Signal"))) %>%
hc_add_series(df) %>%
hc_add_series(SMA((Cl(df)),n=12),name="SMA(12)") %>%
hc_add_series(SMA((Cl(df)),n=26),name="SMA(26)") %>%
hc_add_series(strategy1, name="Estrategia_1", yAxis = 1, color = "#5C469C") %>%
hc_title(text= paste0("<b>", colnames(df)[4], "Price Candle Stick Chart</b>"))
source("C:/Users/bravi/projects/finance1r/strategy_ttr.R", echo=TRUE)
install.packages("highcharter")
install.packages("highcharter")
source("C:/Users/bravi/projects/finance1r/strategy_ttr.R", echo=TRUE)
source("C:/Users/bravi/projects/finance1r/prediction1.R", echo=TRUE)
library(tidyverse)
library(dplyr)
library(quantmod)
library(TTR)
library(PerformanceAnalytics)
library("IRdisplay")
library(highcharter) #Interactive Plot
library(devtools)
library(yahoofinancer)
library(lubridate)
library(rvest)
library(httr)
library(readxl)
library(sets) # to fuzzy model
getSymbols(c("AMZN","DAL"))
df <- AMZN
highchart(type="stock") %>%
hc_add_series(df) %>%
hc_title(text="<b>BBRI Price Candle Stick Chart 2014-2023</b>")
#Interactive Plot
highchart(type="stock") %>%
hc_add_series(price_bbri) %>%
hc_add_series(SMA(na.omit(Cl(price_bbri)),n=50),name="SMA(50)") %>%
hc_add_series(SMA(na.omit(Cl(price_bbri)),n=200),name="SMA(200)") %>%
hc_title(text="<b>BBRI Price Candle Stick Chart 2014-2023</b>")
library(tidyverse)
library(dplyr)
library(quantmod)
library(TTR)
library(PerformanceAnalytics)
library("IRdisplay")
library(highcharter) #Interactive Plot
library(devtools)
library(yahoofinancer)
library(lubridate)
library(rvest)
library(httr)
library(readxl)
library(sets) # to fuzzy model
getSymbols(c("AMZN","DAL"))
df <- AMZN
highchart(type="stock") %>%
hc_add_series(df) %>%
hc_title(text="<b>BBRI Price Candle Stick Chart 2014-2023</b>")
price_bbri <- getSymbols("BBRI.JK", auto.assign=FALSE, from="2014-01-01", to="2023-05-19")
View(price_bbri)
highchart(type="stock") %>%
hc_add_series(price_bbri) %>%
hc_add_series(SMA(na.omit(Cl(price_bbri)),n=50),name="SMA(50)") %>%
hc_add_series(SMA(na.omit(Cl(price_bbri)),n=200),name="SMA(200)") %>%
hc_title(text="<b>BBRI Price Candle Stick Chart 2014-2023</b>")
library(tidyverse)
library(dplyr)
library(quantmod)
library(TTR)
library(PerformanceAnalytics)
library("IRdisplay")
library(highcharter) #Interactive Plot
library(devtools)
library(yahoofinancer)
price_bbri <- getSymbols("BBRI.JK", auto.assign=FALSE, from="2014-01-01", to="2023-05-19")
df <- AMZN
highchart(type="stock") %>%
hc_add_series(price_bbri) %>%
hc_add_series(SMA(na.omit(Cl(price_bbri)),n=50),name="SMA(50)") %>%
hc_add_series(SMA(na.omit(Cl(price_bbri)),n=200),name="SMA(200)") %>%
hc_title(text="<b>BBRI Price Candle Stick Chart 2014-2023</b>")
source("C:/Users/bravi/projects/finance1r/prueba.R", echo=TRUE)
source("C:/Users/bravi/projects/finance1r/prueba.R", echo=TRUE)
source("C:/Users/bravi/projects/finance1r/prueba.R", echo=TRUE)
library(tidyverse)
library(dplyr)
library(quantmod)
library(TTR)
library(PerformanceAnalytics)
library("IRdisplay")
library(highcharter) #Interactive Plot
library(yahoofinancer)
#library(lubridate)
library(rvest)
library(httr)
price_bbri <- getSymbols("BBRI.JK", auto.assign=FALSE, from="2014-01-01", to="2023-05-19")
highchart(type="stock") %>%
hc_add_series(price_bbri) %>%
hc_add_series(SMA(na.omit(Cl(price_bbri)),n=50),name="SMA(50)") %>%
hc_add_series(SMA(na.omit(Cl(price_bbri)),n=200),name="SMA(200)") %>%
hc_title(text="<b>BBRI Price Candle Stick Chart 2014-2023</b>")
highchart(type="stock") %>%
hc_add_series(price_bbri) %>%
hc_title(text="<b>BBRI Price Candle Stick Chart 2014-2023</b>")
# Market performance
market <- getSymbols("^NDX",from=from, to=to, src="yahoo", env = NULL)
from <- "2019-01-01"
to <- "2023-05-26"
stock <- symbols$Symbol[sample(1:nrow(symbols),1)]
from <- "2019-01-01"
to <- "2023-05-26"
# Market performance
market <- getSymbols("^NDX",from=from, to=to, src="yahoo", env = NULL)
# investment stock
prices <- getSymbols(stock,from=from, to=to, src="yahoo", env = NULL)
#---load data for a list of stocks---
# Web scraping to obtain symbols of stocks
page <- paste0('https://www.slickcharts.com/nasdaq100')
data_symbols <- read_html(page, encoding="UTF-8")
class(data_symbols)
html_text(data_symbols)
tabla <- data_symbols |> html_elements(xpath = '//div/table[@class="table table-hover table-borderless table-sm"]')
tabla <- tabla[[1]] |> html_table()
class(tabla)
symbols <- tabla |> select(Company, Symbol)
# ___Inputs___
from <- "2019-01-01"
to <- "2023-05-26"
stock <- symbols$Symbol[sample(1:nrow(symbols),1)]
# Market performance
market <- getSymbols("^NDX",from=from, to=to, src="yahoo", env = NULL)
# investment stock
prices <- getSymbols(stock,from=from, to=to, src="yahoo", env = NULL)
highchart(type="stock") %>%
hc_add_series(prices) %>%
hc_title(text="<b>BBRI Price Candle Stick Chart 2014-2023</b>")
highchart(type="stock") %>%
hc_add_series(prices) %>%
hc_title(text="<b>Prices Candle Stick Chart 2014-2023</b>")
library(tidyverse)
library(dplyr)
library(quantmod)
library(TTR)
library(PerformanceAnalytics)
library("IRdisplay")
library(highcharter) #Interactive Plot
library(yahoofinancer)
#library(lubridate)
library(rvest)
library(httr)
highchart(type="stock") %>%
hc_add_series(prices) %>%
hc_title(text="<b>Prices Candle Stick Chart 2014-2023</b>")
class(market)
class(prices)
colnames(prices) <- c('Open','High','Low','Close','Volume','Adjusted')
colnames(market) <- c('Open','High','Low','Close','Volume','Adjusted')
# Calculus of indicators
add_indicadores <- function(prices){
# MACD
macd <- MACD(prices$Close, nFast = 12, nSlow = 26, nSig = 9, maType = "SMA", percent = FALSE)
colnames(macd) <- c('macd_value', 'macd_signal')
prices <- cbind(prices, macd)
# RSI
rsi <- RSI(prices$Close, n = 14, maType = "SMA")
prices <- cbind(prices, rsi)
# SO Stochastic Oscillator
so <- stoch(prices[,2:4], nFastK = 10, nFastD = 3, nSlowD = 3) * 100
colnames(so)[1] <- 'so'
prices <- cbind(prices, so)
# OBV On Balance Volume
obv <- OBV(prices[,4], prices[,5])
obv$ema <- EMA(obv$obv,n=3) #compute the exponential moving average with n = 3
obv$ema[is.na(obv$ema)] <- 0
prices <- cbind(prices, obv)
# Semidev Calculations
semidev <- rep(NA, 13)
for (i in 14:length(prices$Adjusted)) {
semidev <- c(semidev, SemiDeviation(R = ROC(prices$Adjusted[(i-13):i], n = 1, type = "discrete"),
MAR=0))
}
prices <- cbind(prices, semidev)
prices
}
prices <- add_indicadores(prices)
head(prices)
summary(prices)
#Interactive Plot
highchart(type="stock") %>%
hc_add_series(prices) %>%
hc_title(text="<b>Prices Candle Stick Chart 2014-2023</b>")
#Interactive Plot
highchart(type="stock") %>%
hc_add_series(prices[,1:6]) %>%
hc_title(text="<b>Prices Candle Stick Chart 2014-2023</b>")
quote(prices)
quote(stock)
stock
#Interactive Plot
highchart(type="stock") %>%
hc_add_series(prices[,1:6]) %>%
hc_title(text=paste0("<b>Prices company:", stock,  "2014-2023</b>"))
#Interactive Plot
highchart(type="stock") %>%
hc_add_series(prices[,1:6]) %>%
hc_title(text=paste0("<b>Prices company: ", stock, "</b>"))
View(symbols)
symbols[,"MAR"]
symbols$Symbol["MAR"]
symbols$Symbol["Msft"]
symbols$Symbol["MSFT"]
symbols$Symbol[1]
symbols[1]
symbols[1,1]
symbols[1,]
symbols$Symbol == 'MSFT'
which(symbols$Symbol == 'MSFT')
which(symbols$Symbol == 'AAPL')
which(symbols$Symbol == 'MAR')
symbols[which(symbols$Symbol == 'MAR'),1]
symbols[which(symbols$Symbol == stock),1]
symbols[which(symbols$Symbol == stock),1][1,1]
symbols[which(symbols$Symbol == stock),1]
#Interactive Plot
highchart(type="stock") %>%
hc_add_series(prices[,1:6]) %>%
hc_title(text=paste0("<b>Prices company: ", symbols[which(symbols$Symbol == stock),1], "</b>"))
Cl(prices)
#Interactive Plot
highchart(type="stock") %>%
hc_add_series(prices[,1:6]) %>%
hc_add_series(SMA((Cl(prices)),n=12),name="SMA(12)") %>%
hc_add_series(SMA((Cl(prices)),n=26),name="SMA(26)") %>%
hc_title(text=paste0("<b>Prices company: ", symbols[which(symbols$Symbol == stock),1], "</b>"))
chartSeries(prices[,1:6], subset = "2022-01::2023-05-26")
chartSeries(prices[,1:6], subset = "2022-01::2023-05-26")
addTA(prices[,7], on=1, col='blue', lty='dashed')
chartSeries(prices[,1:6], subset = "2022-01::2023-05-26")
addTA(prices[,9], on=1, col='blue', lty='dashed')
